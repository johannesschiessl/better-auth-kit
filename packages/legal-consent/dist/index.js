import{APIError as B,createAuthMiddleware as H}from"better-auth/api";var v={TOS_NOT_ACCEPTED:"TOS must be accepted",PRIVACY_NOT_ACCEPTED:"Privacy must be accepted",AGE_NOT_ACCEPTED:"Age must be accepted",MARKETING_NOT_ACCEPTED:"Marketing must be accepted",COOKIE_NOT_ACCEPTED:"Cookie must be accepted"},K=(j)=>{let g={requireAgeVerification:j?.requireAgeVerification??!1,requireTOS:j?.requireTOS??!1,requirePrivacyPolicy:j?.requirePrivacyPolicy??!1,requireMarketingConsent:j?.requireMarketingConsent??!1,requireCookieConsent:j?.requireCookieConsent??!1,schema:{userModelName:j?.schema?.userModelName??"user",tosAccepted:j?.schema?.tosAccepted??"tosAccepted",ageVerified:j?.schema?.ageVerified??"ageVerified",marketingConsentAccepted:j?.schema?.marketingConsentAccepted??"marketingConsentAccepted",privacyPolicyAccepted:j?.schema?.privacyPolicyAccepted??"privacyPolicyAccepted",cookieConsentAccepted:j?.schema?.cookieConsentAccepted??"cookieConsentAccepted"}},q={};if(g.requireTOS)q.tosAccepted={type:"boolean",input:!0,required:!0,fieldName:g.schema.tosAccepted};if(g.requirePrivacyPolicy)q.privacyPolicyAccepted={type:"boolean",input:!0,required:!0,fieldName:g.schema.privacyPolicyAccepted};if(g.requireAgeVerification)q.ageVerified={type:"boolean",input:!0,required:!0,fieldName:g.schema.ageVerified};if(g.requireMarketingConsent)q.marketingConsentAccepted={type:"boolean",input:!0,required:!0,fieldName:g.schema.marketingConsentAccepted};if(g.requireCookieConsent)q.cookieConsentAccepted={type:"boolean",input:!0,required:!0,fieldName:g.schema.cookieConsentAccepted};return{id:"legal-consent",hooks:{before:[{matcher:(G)=>G.path.startsWith("/sign-up/email"),handler:H(async(G)=>{let z=G.body;if(g.requireTOS&&z[g.schema.tosAccepted]===void 0)throw new B("BAD_REQUEST",{message:v.TOS_NOT_ACCEPTED});if(g.requirePrivacyPolicy&&z[g.schema.privacyPolicyAccepted]===void 0)throw new B("BAD_REQUEST",{message:v.PRIVACY_NOT_ACCEPTED});if(g.requireAgeVerification&&z[g.schema.ageVerified]===void 0)throw new B("BAD_REQUEST",{message:v.AGE_NOT_ACCEPTED});if(g.requireMarketingConsent&&z[g.schema.marketingConsentAccepted]===void 0)throw new B("BAD_REQUEST",{message:v.MARKETING_NOT_ACCEPTED});if(g.requireCookieConsent&&z[g.schema.cookieConsentAccepted]===void 0)throw new B("BAD_REQUEST",{message:v.COOKIE_NOT_ACCEPTED});return{context:G}})}]},schema:{user:{fields:q,modelName:g.schema.userModelName}},$ERROR_CODES:v}};export{K as legalConsent,v as ERROR_CODES};

//# debugId=E416F9994BA3B7E364756E2164756E21
